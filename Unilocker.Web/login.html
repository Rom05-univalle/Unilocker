<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <title>Login - Unilocker Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
</head>
<body>
<script type="module">
import { isAuthenticated } from './js/auth.js';
if (isAuthenticated()) window.location.href = "dashboard.html";
</script>

<div class="page-content">
    <div class="container d-flex justify-content-center align-items-center" style="height: 100vh;">
        <div class="card p-4 shadow login-card" style="width:350px;">
            <h4 class="mb-4 text-center">Iniciar sesión</h4>

            <!-- Paso 1: usuario/contraseña -->
            <form id="loginForm">
                <div class="mb-3">
                    <label for="inputUser" class="form-label">Usuario</label>
                    <input type="text" id="inputUser" class="form-control" required autocomplete="username"/>
                </div>
                <div class="mb-3">
                    <label for="inputPass" class="form-label">Contraseña</label>
                    <input type="password" id="inputPass" class="form-control" required autocomplete="current-password"/>
                </div>
                <div id="loginError" class="text-danger mb-3" style="display:none;"></div>
                <button type="submit" class="btn btn-uni-primary w-100" id="btnLogin">
                    Entrar
                </button>
            </form>

            <!-- Paso 2: verificación de código (oculto al inicio) -->
            <form id="verificationForm" style="display:none;">
                <p class="mb-2">
                    Se envió un código de 6 dígitos a tu correo institucional.
                </p>
                <div class="mb-3">
                    <label for="inputCode" class="form-label">Código de verificación</label>
                    <input type="text" id="inputCode" class="form-control" maxlength="6"
                           inputmode="numeric" pattern="\d{6}" required />
                </div>

                <div class="d-flex justify-content-end align-items-center mb-2">
                    <button type="button" class="btn btn-link p-0" id="btnResend" disabled>
                        Reenviar código
                    </button>
                </div>

                <div id="verificationError" class="text-danger mb-3" style="display:none;"></div>

                <button type="submit" class="btn btn-uni-primary w-100" id="btnVerify">
                    Verificar
                </button>
            </form>

        </div>
    </div>
</div>

<footer class="py-3 bg-dark">
    <div class="container text-center">
        <span class="text-light">Univalle para toda la vida</span>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script type="module" src="./js/login.js"></script>
</body>
</html>
